---
title: 使用 Excel 创建负载测试性能报告
description: 了解如何基于两个或多个测试结果生成 Microsoft Excel 负载测试报告。 可以创建运行比较报告和趋势报告。
ms.custom: SEO-VS-2020
ms.date: 10/19/2016
ms.topic: how-to
helpviewer_keywords:
- load tests, creating Excel reports
- load tests, reporting
ms.assetid: b87fb196-9973-4512-a924-088788def4ea
author: mikejo5000
ms.author: mikejo
manager: jmartens
ms.technology: vs-ide-test
ms.openlocfilehash: f40d477122bbf3fe0057fa1010b9847fa5a7cae0
ms.sourcegitcommit: 68897da7d74c31ae1ebf5d47c7b5ddc9b108265b
ms.translationtype: HT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/13/2021
ms.locfileid: "122075848"
---
# <a name="how-to-create-load-test-performance-reports-using-microsoft-excel"></a>如何：使用 Microsoft Excel 创建负载测试性能报告

可以生成基于两个或更多测试结果的 Microsoft Excel 负载测试报告。

[!INCLUDE [web-load-test-deprecated](includes/web-load-test-deprecated.md)]

负载测试报告分为两种：

- **运行比较** 这种方式会创建一组报告，它们使用表和条形图比较两个负载测试结果的数据。

- **趋势** 可基于两个或更多负载测试结果生成趋势分析。 其结果以折线图显示，但可从数据透视表获得数据。

> [!TIP]
> 也可以通过从摘要视图、关系图视图和表视图中复制和粘贴数据来手动创建 Microsoft Word 报告。 请参阅[如何：使用 Microsoft Word 手动创建负载测试性能报告](../test/how-to-manually-create-a-load-test-performance-report-using-microsoft-word.md)。

这两种报告都可用于与利益干系人共享性能数据，传达系统的整体性能和运行状况是变好还是变差。

报告定义存储在负载测试数据库中。 保存报告后，报告定义保存在数据库中，以后可以重用。

此外，可将 Excel 工作簿与利益干系人共享 ，以便利益干系人不必连接到数据库就可以查看报告。

> [!NOTE]
> 可以共享 Excel 工作簿；但是，只有计算机上已安装 Visual Studio 的用户能够修改任意电子表格。 其他用户在 Office 功能区中将看不到“负载测试报告”选项，但他们将能查看工作簿   。

下图是显示处理（更新购物车）速度的下降和（% 处理器）计数器的退化之间的相关性的报告示例。 这指向应用程序代码而不是数据库或网络中的潜在问题，并且适于使用 ASP.NET 探查器进行诊断。

![应用程序代码中的潜在问题](../test/media/lt_excel.png)

生成 Excel 报告的方法有两种：一种是在负载测试分析器中使用工具栏中的“创建 Excel 报告”按钮，另一种是在 Excel 中使用 Office 功能区的“负载测试”选项卡中的“负载测试报告”选项      。

> [!NOTE]
> 如果向负载测试添加注释，它们将显示在 Excel 报告中。

## <a name="to-generate-load-test-comparison-reports-using-excel"></a>使用 Excel 生成负载测试比较报告

1. 在生成报告之前，必须先运行负载测试。

2. 可采用两种方法创建 Excel 负载测试报告：

   - 完成负载测试之后，在“负载测试结果”页中，选择工具栏中的“创建 Excel 报告”按钮   。

      > [!NOTE]
      > 如果“创建 Excel 报告”  按钮在“Web 性能测试结果查看器”  工具栏中处于禁用状态，可能需要运行一次 Microsoft Excel 才能启用该按钮。 安装 Visual Studio Enterprise 时，Visual Studio Enterprise 负载测试外接程序将会复制到你的计算机以便用于 Microsoft Excel；但是必须运行 Microsoft Excel 才能完成该外接程序的安装过程。

      Microsoft Excel 将打开“生成负载测试报告”向导  。

   **或**

   1. 打开 Microsoft Excel，选择 Office 功能区中的“负载测试”选项卡，然后选择“负载测试报告”    。

       此时将显示“生成负载测试报告”向导  。

   2. 在“选择包含负载测试的数据库”页的“服务器名称”下，键入包含负载测试结果的服务器的名称   。

   3. 在“数据库名称”下拉列表中，选择包含负载测试结果的数据库  。

3. 在“要如何生成你的报告”页上，确认选中“创建报告”，然后选择“下一步”    。

4. 在“你希望生成哪种类型的报告”页中，确认选中“运行比较”，然后选择“下一步”    。

5. 在“输入负载测试报告详细信息”页上，在“报告名称”中键入报告的名称   。

6. 选择要为其生成报告的负载测试，然后选择“下一步”  。

7. 在“为报告选择运行”页的“选择一个或多个要添加到报告中的运行”下面，选择要在报告中比较的两个负载测试结果，然后选择“下一步”    。

   > [!NOTE]
   > 只能针对两个负载测试结果生成一个比较报告。 如果选择一个负载测试结果或两个以上负载测试结果，则将显示一条警告消息。

8. 在“为报告选择计数器”页上的“选择一个或多个要添加到报告中的计数器”下面，有一个可用于自定义报告的可扩展计数器列表   。 从报告中两个所选的测试运行中选择要进行比较的计数器，然后选择“完成”  。

9. 将生成带有以下电子表格选项卡的 Excel 工作簿：

   - **目录** - 显示负载测试报告名称，并提供一个目录，其中包含指向报告的各选项卡的链接。

   - **运行** - 提供有关正在比较报告中的哪两个运行的详细信息。

   - **测试比较** - 提供有关正在比较的两个运行之间的性能衰退和改进的条形图详细信息。

   - **页面比较** - 提供测试运行中的各个页面上两个运行之间的条形图和百分比性能比较数据。

   - **计算机比较** - 提供基于所使用的计算机的两个运行之间的比较数据。

   - **错误比较** - 比较在两个运行中所遇到的错误类型以及出现的次数。

     > [!TIP]
     > 为了获得更好的报告，支持更多报告的负载测试和 Web 性能测试提供了几个属性。 页面请求具有两个呈现在报告中的属性：“目标”和“报告名称”。 将针对目标来报告页面响应时间，并且在报告中将使用报告名称而不是 URL。 在负载测试“运行设置”的“管理计数器集”下面，“计算机标记”属性呈现在报告计算机名称中。 若要在报告中描述特定计算机的角色，这非常有用。

## <a name="to-generate-load-test-trend-reports-using-excel"></a>使用 Excel 生成负载测试趋势报告

1. 在生成报告之前，必须运行负载测试。

2. 可采用两种方法创建 Excel 负载测试报告：

   - 完成负载测试之后，在“负载测试结果”页中，选择工具栏中的“创建 Excel 报告”按钮   。

      > [!NOTE]
      > 如果“创建 Excel 报告”  按钮在“Web 性能测试结果查看器”  工具栏中处于禁用状态，可能需要运行一次 Microsoft Excel 才能启用该按钮。 安装 Visual Studio Enterprise 时，Visual Studio Enterprise 负载测试外接程序将会复制到你的计算机以便用于 Microsoft Excel；但是必须运行 Microsoft Excel 才能完成该外接程序的安装过程。

      Microsoft Excel 将打开“生成负载测试报告”向导  。

   **或**

   1. 打开 Microsoft Excel，选择 Office 功能区中的“负载测试”选项卡，然后选择“负载测试报告”    。

       此时将显示“生成负载测试报告”向导  。

   2. 在“选择包含负载测试的数据库”页的“服务器名称”下，键入包含负载测试结果的服务器的名称   。

   3. 在“数据库名称”下拉列表中，选择包含负载测试结果的数据库  。

3. 在“要如何生成你的报告”页上，确认选中“创建报告”，然后选择“下一步”    。

4. 在“你希望生成哪种类型的报告”页中，确认选中“趋势”，然后选择“下一步”    。

5. 在“输入负载测试报告详细信息”页上，在“报告名称”中键入报告的名称   。

6. 选择要为其生成报告的负载测试，然后选择“下一步”  。

7. 在“为报告选择运行”页的“选择一个或多个要添加到报告中的运行”下面，选择要在报告中比较的负载测试结果，然后选择“下一步”    。

8. 在“为报告选择计数器”页上的“选择一个或多个要添加到报告中的计数器”下面，有一个可用于自定义报告的可扩展计数器列表   。 选择要比较来进行趋势分析的计数器，然后选择“完成”  。

9. 将生成带有一个目录的报告，该目录包含指向报告中生成的各个 Excel 工作簿选项卡的链接。 这些链接基于为趋势报告选择的计数器。 例如，如果在步骤 7 中将默认计数器保留为选中状态，则报告所生成的数据将针对步骤 7 中列出的每个计数器，呈现在 Excel 中的各个选项卡上。 针对每个计数器生成的数据呈现在趋势图中。

   > [!TIP]
   > 为了获得更好的报告，支持更多报告的负载测试和 Web 性能测试提供了几个属性。 页面请求具有两个呈现在报告中的属性：“目标”和“报告名称”。 将针对目标来报告页面响应时间，并且在报告中将使用报告名称而不是 URL。 在负载测试“运行设置”的“管理计数器集”下面，“计算机标记”属性呈现在报告计算机名称中。 若要在报告中描述特定计算机的角色，这非常有用。

## <a name="net-security"></a>.NET 安全性

负载测试结果和报告包含的潜在敏感信息可用于生成针对你的计算机或网络的攻击。 负载测试结果和报告包含计算机名称和连接字符串。 在与他人共享负载测试报告时应注意这一点。

## <a name="see-also"></a>另请参阅

- [报告负载测试结果以进行测试比较或趋势分析](../test/compare-load-test-results.md)
