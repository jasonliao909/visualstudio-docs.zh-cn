---
title: 调试 T4 文本模板
description: 若要调试设计时文本模板，请保存文本模板文件，然后选择"调试 T4 模板"，再在 解决方案资源管理器。
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: conceptual
helpviewer_keywords:
- text templates, troubleshooting
- text templates, debugging
author: mgoertz-msft
ms.author: mgoertz
manager: jmartens
ms.technology: vs-ide-modeling
ms.workload:
- multiple
ms.openlocfilehash: 360c007363e8e5b559e3c95481a014c4c453093fa1ecac804b42f986ad2f8988
ms.sourcegitcommit: c72b2f603e1eb3a4157f00926df2e263831ea472
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/12/2021
ms.locfileid: "121398224"
---
# <a name="debugging-a-t4-text-template"></a>调试 T4 文本模板
可以在文本模板中设置断点。 若要调试设计时文本模板，请保存文本模板文件，然后在文本模板中文件的快捷菜单上选择"调试 **T4** 模板解决方案资源管理器。 若要调试运行时文本模板，只需调试它所属的应用程序。

 若要调试文本模板，应了解模板转换过程的步骤。 每个步骤中可能会发生不同类型的错误。 步骤如下。

|步骤|设计时模板：发生时|运行时模板：发生时|
|-|-|-|
|代码从文本模板生成。<br /><br /> 指令中的错误，或不匹配或有误的 `<#...#>` 标记。|保存模板或调用文本转换时。|保存模板或调用文本转换时。|
|生成的代码已编译。<br /><br /> 模板代码中的编译错误。|紧接在上一步之后。|以及应用程序代码。|
|代码运行。<br /><br /> 模板代码中的运行时错误。|紧接在上一步之后。|当应用程序运行并调用模板代码时。|

 在大多数情况下，模板代码中的行号在错误报告中提供。 当错误报告引用临时文件名时，通常原因是文本模板代码中的方括号不匹配。

 可以在文本模板中设置断点，并按常规方式进行调试。

## <a name="common-errors-and-fixes"></a>常见错误和修复
 下表列出了最常见的错误及其修复。

|错误消息|说明|解决方案|
|-|-|-|
|无法加载转换类继承 {0} 自的基类''。|如果找不到模板指令中的 参数中指定的 `inherits` 基类，则发生。 该消息提供模板指令的行号。|请确保指定的类存在，并且它存在于 中的程序集在程序集指令中指定。|
|无法解析文件的包含文本：{0}|在找不到包含的模板时发生。 该消息提供所请求的包含文件的名称。|请确保文件路径相对于原始模板路径，或者文件位于向主机注册的位置，或者文件的完整路径。|
|初始化转换对象时生成错误。 转换不会运行。|当转换类的"initialize () "失败或返回 false 时发生。|Initialize () 函数中的代码来自 指令中指定的基转换类和 \<#@template#> 指令处理器。 导致初始化失败的错误可能位于错误列表中。 调查失败的原因。 可以按照调试模板的过程 () 初始化模板的实际生成代码。|
|未向指令处理器""的程序集 {0} {1} ""授予 FullTrust 权限集。 仅允许受信任的程序集提供指令处理器。 不会加载此指令处理器。|当系统不向包含指令处理器的程序集授予 FullTrust 权限时发生。 该消息提供程序集的名称和指令处理器的名称。|请确保仅在本地计算机上使用受信任的程序集。|
|路径 {0} ""必须是此计算机的本地路径，或者是受信任区域中的一部分。|当指令或程序集指令引用不在本地计算机或网络受信任区域中的文件时发生。|请确保指令或程序集指令所在的目录位于受信任的区域中。 可以通过管理帐户将网络目录添加到受信任Internet Explorer。|
|多个语法错误，例如"无效标记'catch'"或"命名空间不能直接包含成员"|模板代码中的右大括号太多。 编译器将它与标准生成代码混淆。|检查代码分隔符内的右大括号和括号的数量。|
|未正确编译或执行的循环或条件。 例如：`<#if (i>10)#> Number is: <#= i #>`。<br /><br /> 此代码始终输出 i 的值。 只有"Number is："是条件。|在 C# 中，始终使用大括号来环绕嵌入在控件语句中的文本块。|添加大括号 `<#if (i>10) { #>    Number is: <#= i #><# } #>` ：。|
|处理设计时模板或将运行时编译为预处理 (模板时，"表达式) 复杂"。<br /><br /> Visual Studio检查运行时模板生成的代码时，代码停止工作。|文本块太长。 T4 将文本块转换为字符串串联表达式，每个模板行都有一个字符串文本。 非常长的文本块可能会超过编译器的大小限制。|使用表达式块分解长文本块，例如：<br /><br /> `<#= "" #>`|

## <a name="warning-descriptions-and-fixes"></a>警告说明和修复
 下表列出了最常见的警告以及修补程序（如果可用）。

|警告消息|说明|解决方案|
|-|-|-|
|加载包含文件 {0} '' 返回了 null 或空字符串。|如果包含的文本模板文件为空，则发生。 该消息提供包含文件的文件名。|删除 include 指令或确保文件包含某些内容。|
|编译转换：|在编译器编译转换时，在此字符串的开头是源自编译器的所有错误或警告。 此字符串表示编译器引发了错误或警告。|如果在查找 DLL 时出现问题，可能需要提供完整路径或完全限定的强名称（如果 DLL 位于 GAC 中）。|
|指令中 {0} 已存在参数""。 将忽略重复参数。|在 指令中多次指定参数时发生。 该消息提供 参数的名称和 指令的行号。|删除重复的参数规范。|
|加载包含文件''时 {0} 出错。 将忽略 include 指令。|在找不到 指令中指定的文件时 `include` 发生。 该消息提供文件名和 指令的行号。|请确保包含文件与原始文本模板文件位于同一目录中，或者存在于向主机注册的其中一个包含目录中。|
|为 Transformation 类指定了无效的基类。 基类必须派生自 Microsoft.VisualStudio.TextTemplating.TextTransformation。|当模板指令中的 参数指定不从 继承的类 `inherits` 时发生 `TextTransformation` 。 该消息提供模板指令的行号。|指定派生自的类 `TextTransformation` 。|
|在 "template" 指令中指定的区域性无效。 区域性的格式必须为 "xx-XX"。 将使用固定区域性。|如果未正确指定模板指令中的区域性参数，则发生此事件。 消息提供模板指令的行号。|将 culture 参数更改为 "xx-XX" 格式的有效区域。|
|在 template 指令中指定了无效的调试值 " {0} "。 调试值必须是 "true" 或 "false"。 将使用默认值 "false"。|`debug`错误地指定了模板指令中的参数时发生。 消息提供模板指令的行号。|将 debug 参数设置为 "true" 或 "false"。|
|在 template 指令中指定了无效的 HostSpecific 值 " {0} "。 HostSpecific 值必须是 "true" 或 "false"。 将使用默认值 "false"。|如果未正确指定指令中特定于宿主的参数，则出现此 `template` 错误。 消息提供模板指令的行号。|将特定于主机的参数设置为 "true" 或 "false"。|
|{0}在 "template" 指令中指定了无效的语言 ""。 语言必须是 "c #" 或 "VB"。 将使用默认值 "c #"。|在指令中指定了不受支持的语言时发生 `template` 。 仅允许使用 "c #" 或 "VB" (不区分大小写) 。 消息提供模板指令的行号。|将 `language` 模板指令中的参数设置为 "c #" 或 "VB"。|
|在模板中找到多个输出指令。 除第一个以外的所有项都将被忽略。|在 `output` 模板文件中指定多个指令时发生。 消息提供重复的 output 指令的行号。|删除重复 `output` 的指令。|
|在模板中找到多个模板指令。 除第一个以外的所有项都将被忽略。 应在一个模板指令中指定模板指令的多个参数。|如果在 `template` 文本模板文件中指定多个指令 (包括) 包含文件，则会发生此错误。 消息提供重复模板指令的行号。|将不同 `template` 指令聚合为一个 `template` 指令。|
|没有为名为 "" 的指令指定任何处理器 {0} 。 指令将被忽略。|如果指定 `custom` 指令，但未提供属性，则会发生此错误 `processor` 。 消息提供指令的名称和行号。|提供一个 `processor` 属性，其中包含指令的 `directive` 处理器名称。|
|{0}对于名为 "" 的指令，找不到名为 "" 的处理器 {1} 。 指令将被忽略。|系统找不到 `directive` 指令中指定的处理器时发生 `custom` 。 消息提供指令名称、处理器名称和指令的行号。|将 `processor` 指令中的属性设置为指令处理器的名称。|
|{0}找不到指令 "" 所需的参数 "" {1} 。 指令将被忽略。|系统未提供所需的指令参数时发生。 消息提供缺少的参数的名称、指令名称和行号。|提供缺少的参数。|
|名为 "" 的处理器 {0} 不支持名为 "" 的指令 {1} 。 指令将被忽略。|指令处理器不支持指令时发生。 消息提供了有问题的指令的名称和行号以及指令处理器的名称。|更正指令的名称。|
|文件 "" 的 include 指令 {0} 导致无限循环。|如果指定了循环包含指令，则显示 (例如，文件 A 包含文件 B，其中包含文件 A) 。|不要指定循环包含指令。|
|正在运行转换：|在运行转换时生成的所有错误或警告前面预置此字符串。|不适用。|
|在块中发现意外的开始或结束标记。 请确保未错误键入开始或结束标记，并且模板中没有任何嵌套块。|出现意外情况时显示 \<# or #> 。 也就是说，如果你有一个在 \<# after another open tag that has not been closed, or you have a #> 其之前没有未闭合的打开标记。 消息提供不匹配标记的行号。|删除不匹配的开始或结束标记，或使用转义符。|
|指定了指令的格式不正确。 指令将被忽略。 请用格式指定指令。 `<#@ name [parametername="parametervalue"]*  #>`|如果未以正确的格式指定指令，则由分析器显示。 消息提供不正确的指令的行号。|确保所有指令均为形式 `<#@ name [parametername="parametervalue"]*  #>` 。 有关详细信息，请参阅 [T4 文本模板指令](../modeling/t4-text-template-directives.md)。|
|无法 {0} 为注册的指令处理器 "" 加载程序集 "" {1}<br /><br /> {2}|当主机无法加载指令处理器时发生。 此消息标识为指令处理器提供的程序集和指令处理器的名称。|请确保指令处理器已正确注册并且该程序集存在。|
|{0}在程序集 "" 中找不到 {1} 已注册的指令处理器 " {2} " 的类型 ""<br /><br /> {3}|当无法从程序集加载指令处理器类型时发生。 消息提供类型、程序集和指令处理器的名称。|Vshost.exe 在注册表中查找指令处理器信息 (名称、程序集和类型) 。 请确保指令处理器已正确注册，并且该类型存在于程序集中。|
|加载程序集 "" 时出现问题 {0}|在加载程序集时出现问题时发生。 消息提供程序集的名称。|您可以指定要在指令中加载的程序集 \<@#assembly#> 以及指令处理器。 此字符串后面的错误消息应提供有关程序集加载失败的原因的更多数据。|
|为名为 "" 的指令创建和初始化处理器时出现问题 {1} 。 处理器的类型为 {0} 。 指令将被忽略。|当系统无法创建或初始化指令处理器时发生。 消息提供指令的名称和行号，以及处理器的类型。|请确保使用正确的指令处理器，并且指令处理器具有公共的默认构造函数。 否则，请使用调试选项来找出指令处理器的 Initialize () 方法失败的原因。 有关详细信息，请参阅 [疑难解答文本模板](../modeling/debugging-a-t4-text-template.md)。|
|处理名为 "" 的指令时引发了异常 {0} 。|当指令处理器在处理指令时引发异常时发生。|请确保指令处理器的参数正确无误。|
|主机在尝试解析程序集引用""时引发了 {0} 异常。|当主机尝试解析程序集引用时引发异常时发生。 该消息提供程序集引用字符串。|程序集引用来自 \<@#assembly#> 指令和 指令处理器。 请确保程序集参数中提供的"name"参数正确无误。|
|尝试为 指令指定不 {1} 受支持的 {0} 值'' {2}|当提供不受支持的要求或提供参数时，由 RequiresProvidesDirectiveProcessor (生成的所有指令处理器都派生自) 。|请确保 中提供的 name='value' 对中的名称需要 并提供参数是正确的。|
