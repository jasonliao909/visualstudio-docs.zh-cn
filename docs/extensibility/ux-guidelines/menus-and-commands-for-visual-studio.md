---
title: 菜单和命令Visual Studio |Microsoft Docs
description: 了解为用户创建新功能时，命令栏如何在用户界面中实现灵活性Visual Studio。
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: reference
ms.assetid: 0a1ed675-2bd1-4603-ba3a-f40dfb5cfb69
author: leslierichardson95
ms.author: lerich
manager: jmartens
ms.technology: vs-ide-sdk
ms.workload:
- vssdk
ms.openlocfilehash: f137ba0db635587824ef0b574e090b8ba2b806d37855cd23a12978675ee8a81a
ms.sourcegitcommit: c72b2f603e1eb3a4157f00926df2e263831ea472
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/12/2021
ms.locfileid: "121305108"
---
# <a name="menus-and-commands-for-visual-studio"></a>Visual Studio 的菜单和命令
## <a name="command-usage"></a>命令用法

### <a name="overview"></a>概述
 与 Microsoft Office（包含许多单独产品的套件）不同，Visual Studio包含许多产品，每个产品都向全局 IDE 提供其Visual Studio集。 IDE 通过根据上下文筛选可供用户使用的功能，管理数千个命令的复杂性。

 当用户的上下文发生更改（例如从设计窗口切换到代码编辑窗口）时，与新上下文无关的功能会消失。 同时，新功能与相关的动态信息（如"属性"和"工具箱"选项）一起显示。 用户不应注意到可用命令集的交换。 如果用户因命令出现或消失而分散注意力或感到困惑，则 UI 设计需要调整。 用户的当前上下文始终以一种或多种方式指示，例如，在 IDE 标题栏、属性窗口或"属性页"对话框中。

 命令栏允许 UI 中的灵活性。 自定义环境所固有的唯Visual Studio结构是主菜单和主命令栏，它们既可自定义，也可以隐藏。 其他命令栏根据应用程序的状态显示和消失。 工具窗口和文档编辑器还可以在其窗口边缘内包含嵌入的工具栏。

#### <a name="basic-guidelines"></a>基本准则

##### <a name="use-existing-shared-commands-command-groups-and-menus-whenever-possible"></a>尽可能使用现有的共享命令、命令组和菜单。
 由于命令通常基于上下文显示，因此使用现有的共享菜单和命令组可确保命令结构在上下文中的更改之间保持相对稳定。 重新使用共享命令以及将新命令放置在相关共享命令附近还可以降低 IDE 复杂性，并创建更友好的用户体验。 如果需要定义新命令，请尝试将该命令放在现有的共享命令组中。 如果需要定义新组，请先将该组放在现有共享菜单中，靠近相关命令组，然后再创建新的顶级菜单。

##### <a name="do-not-create-icons-for-every-command"></a>不要为每个命令创建图标。
 创建命令图标之前，请仔细考虑。 应仅为以下命令创建图标：

- 显示在默认工具栏上。

- 用户可能会通过"自定义..."对话框添加到 **工具栏** 。

- 具有与另一 Microsoft 产品中的相同操作关联的图标。

##### <a name="limit-the-addition-of-keyboard-shortcuts"></a>限制添加键盘快捷方式
 绝大多数用户采用所有可用快捷方式中的一小部分。 如有疑问，请勿将功能绑定到键盘快捷方式。 在添加新快捷方式之前，请与用户体验团队合作。

##### <a name="give-commands-a-default-menu-placement"></a>为命令提供默认菜单位置。
 请注意，你的命令由其他人自定义，并相应地进行设计。 没有隐藏命令这样的操作。 所有Visual Studio命令都显示在"工具">"自定义"对话框、"命令窗口"、"自动完成"、"工具">"选项 **">"** 键盘"对话框以及"开发工具环境" (DTE) 。  请确保在 .进行文件中为命令提供名称和工具提示，以便用户可以轻松找到它们。

##### <a name="do-not-duplicate-shared-commands-on-an-embedded-toolbar"></a>不要复制嵌入工具栏上的共享命令。
 将命令放在靠近用户焦点区域的位置很有用。 为此，一种方式是在工具窗口或文档编辑器顶部创建嵌入工具栏。 工具栏上放置的命令应特定于窗口中的内容区域。 不要复制这些工具栏上的共享命令。 例如，切勿在嵌入式工具栏中放置"保存"图标。

### <a name="content-and-command-visibility"></a>内容和命令可见性
 命令存在于以下作用域中： **环境**、 **层次结构** 和 **文档**。 了解每个范围，以便对命令放置具有置信度。

 环境作用域 **中的命令** 建立主上下文，并在多个上下文之间共享。 它们更改文档和工具窗口的可见性或排列方式。 环境作用域中的命令包括"新建"Project、连接到服务器、**附加****进程**、剪切、复制、**粘贴**、**查找**、**选项**、**自定义**、新建窗口和 **查看帮助**。  

 层次结构作用域 **中的命令** 管理层次结构 **Visual Studio包括** Project、**团队****和数据**。 它们与项目的子上下文相关 -例如，调试、**生成**、**测试**、**体系结构** 或 **分析**。 层次结构作用域中的命令 **包括"添加新** 项"、"新建查询Project 设置、添加新数据源、启动性能向导 **和新关系图"**。 

 文档范围 **中的** 命令对文档内容（如代码、设计或工作项查询） (WIQ) 。 它们还处理工具窗口的视图，或者特定于该工具窗口。 文档范围命令还处理本身特定于层次结构的文件对象，例如从 **Project。** 文档范围中的命令包括"重构">重命名、创建工作项 **副本**、展开"全部 **"、"****全部折叠**"和"**创建用户任务"。**

### <a name="command-placement-decisions"></a>命令放置决策
 决定创建命令后，需要确定命令的适当位置以及是否创建键盘快捷方式。 按照此决策路径确定命令的放置位置：

 ![命令放置决策图表](../../extensibility/ux-guidelines/media/0501-a_commandplacement.png "0501-a_CommandPlacement")

 **命令在目标位置的决策Visual Studio**

### <a name="command-placement-in-menus"></a>命令在菜单中的位置

#### <a name="main-menu-bar"></a>主菜单栏
 主菜单栏应是参与 UI 的任何上下文特定菜单包的命令的标准位置。 主菜单栏与其他命令结构不同，因为环境使用它来控制哪些命令可见。 所有其他命令栏只是禁用上下文外的命令，无论这些命令放置在菜单上还是工具栏上。

 环境定义内置于主菜单栏中的一组命令，这些命令在整个 IDE 和多个任务域中很常见。 无论将哪些 VSPackage 加载到环境中，这些命令始终可见。 虽然 VSPackage 可以扩展这组命令，但每个产品的命令集及其命令的位置由每个团队负责。

 主菜单Visual Studio可细分为以下菜单类别：

##### <a name="core-menus"></a>核心菜单

- 文件

- 编辑

- 查看

- 工具

- 窗口

- 帮助

##### <a name="project-specific-menus"></a>Project菜单

- 项目

- 构建

- 调试

##### <a name="context-specific-menus"></a>上下文特定的菜单

- 组

- 数据

- 测试

- 体系结构

- 分析

##### <a name="document-specific-menus"></a>文档特定的菜单

- 格式

- 表

##### <a name="when-designing-main-menus-adhere-to-these-rules"></a>设计主菜单时，请遵循以下规则：

- 给定上下文中不超过 25 个顶级项

- 菜单的高度不应超过 600 像素。

- 在多个上下文中评估主菜单，例如，在 Ultimate SKU 和 General Profile 中。

- 可接受弹出菜单。

- 弹出菜单应包含至少三个项，且不超过七个。

- 弹出菜单应只具有一个级别深度 - 某些Visual Studio菜单项具有级联子菜单，但不建议此模式。

- 使用不超过六个分隔符。 分组应遵循下图：

     ![主菜单分组指南](../../extensibility/ux-guidelines/media/0501-b_mainmenus.png "0501-b_MainMenus")

- 虽然图中不需要每个分组，但添加其他分组却受到限制。

- 每个分组应有两到七个菜单项。

#### <a name="main-menu-ordering"></a>主菜单排序
 在添加新的顶级项之前，请考虑将命令置于现有的顶级菜单中。 添加新的顶级菜单时，请确保将其放在正确的位置。 决定菜单是特定于项目、上下文还是文档。 使顶级菜单的名称简洁明了，只使用一个词。

 核心菜单应 bookend 命令的其余部分。 "文件"、"编辑" 和 "视图" 应始终在左侧，而 "工具"、"窗口" 和 "帮助" 应始终位于右侧。

#### <a name="context-menus"></a>上下文菜单
 在上下文菜单中放置过多功能会导致难以理解的界面。 所有主要功能都应该通过主菜单栏提供。 应将命令的位置与现有命令协调在一起，以避免重复的命令。 对于上下文菜单，shell 定义应该包含的标准菜单组，具体取决于上下文菜单是用于解决方案、项目节点还是项目项。

 设计上下文菜单时，遵循与主菜单相同的规则，此外还包括：

- 不能超过25个顶级菜单项。

- 飞出菜单是可接受的，但不得超出一级-从不使用级联浮出控件。

- 使用不超过六个分隔符。

### <a name="command-placement-in-toolbars"></a>工具栏中的命令放置

#### <a name="general-toolbars"></a>常规工具栏
 设计和排列工具栏时，请遵循以下标准：

- 不要对每个按钮使用多个谓词。 一个按钮 = 一个操作。

- 仅当需要使用标签来加强时，将文本与图标一起使用。

- 仅将组合框用于在一个会话中多次切换的属性。 否则，在其他位置公开此属性。

- 组合框的宽度应该等于框中最大项的宽度 + 30%。 例如，如果最长的项为200像素，则组合框的宽度应为260像素。

- 限制使用分隔符。 在下拉列表旁边使用分隔符是一种反模式，因为下拉列表本身的形状用作视觉分隔符。

- 图标组应包含三到六个图标。

- 如果限定符产生多个有用的命令，请使用存储最后一个设置的拆分按钮：

     ![Visual Studio 中的“拆分”按钮](../../extensibility/ux-guidelines/media/0501-c_splitbuttons.png "0501-c_SplitButtons")

     **拆分按钮的示例。左侧的六个命令可以转到单个按钮。**

#### <a name="product-specific-toolbars"></a>特定于产品的工具栏
 每个产品都可以提供一个默认的工具栏，其中包含经常使用的和重要的命令，每个产品的默认工具栏应在产品安装后第一次启动 Visual Studio 时显示。

 产品还应利用 IDE 提供的共享命令组和菜单。 每个共享命令组放置在一个共享菜单中，旨在以一种有意义的方式为用户组织相关命令。 务必要利用此共享的命令结构，以降低复杂性。

#### <a name="global-toolbars"></a>全局工具栏
 需要全局工具栏，才能在右侧容纳一行。 创建新的全局工具栏时，请遵循该工具栏类型的指导原则。

 **常规工具栏指南：**

- 每个工具栏在公共控件中有24个像素 (手柄，溢出) 。

- 每个工具栏按钮都是22像素宽，包括填充。 将图标设为拆分按钮将增加11个宽度的宽度。

- 允许跨工具栏复制命令。

  特定文件类型处于活动状态时，将显示 **特定于文档的工具栏**，在不同的文件类型变为活动状态时消失。

- 特定于文档的工具栏不能有12个以上的按钮。

- 工具栏的总宽度不得超过300像素。

- 每个文件类型可以有一个嵌入工具栏或一个特定于文档的全局工具栏，但不能同时包含两者。

  设置特定上下文时，将显示 **特定于上下文的工具栏**，并使长时间保持活动状态。

- 所有特定于上下文的工具栏的按钮限制为18。

- 如果大多数用户在上下文处于活动状态时不会一直使用此工具栏的命令，则不要将此工具栏与上下文相关联。

- 确保在退出上下文时工具栏消失。 在启动时，这些工具栏都不应出现。

  不会自动显示 **没有上下文的工具栏**。 仅当用户激活这些文件时，才会显示这些。 将最大宽度保持为200像素以下。

### <a name="general-organization-and-shell-defined-groups"></a>一般组织和 shell 定义的组
 使用现有的共享命令、命令组和菜单。 如果需要定义新命令，请尝试将其放入现有的共享命令组。 如果需要定义新组，请在创建新的顶级菜单之前，尝试将其放在靠近相关命令组的现有共享菜单中。 这会降低命令的复杂性，同时确保 IDE 中的命令位置一致。

 下图演示了 "共享 **格式** " 菜单，通常显示在设计器样式的文档窗口的上下文中：

 ![具有标注的 Visual Studio 格式菜单](../../extensibility/ux-guidelines/media/0501-d_formatmenu.png "0501-d_FormatMenu")

 **Visual Studio 中的菜单组**

### <a name="reducing-and-reusing-commands"></a>减少和重复使用命令
 命令通常基于上下文显示，以减少用户在任意给定时间看到的命令数。 但是，还应重复使用现有的共享菜单和命令组，以确保在上下文中发生更改时，命令结构保持相对稳定。

 重复使用共享命令并将新的命令放在相关的共享命令上可降低 IDE 复杂性，并创建更易于用户使用的体验。

## <a name="naming-commands"></a>命名命令

### <a name="naming-conventions"></a>命名约定
 一致的命令命名非常重要，因此用户可以通过使用命令行或绑定到键盘快捷键来查找和执行命令。 命令名称还有助于用户了解命令在工具栏上或级联或上下文菜单中显示时的作用。

#### <a name="when-naming-commands"></a>命名命令时：

- 构建文本，使其易于本地化。 有关本地化文本的详细信息，请参阅 [本地化最佳实践](/dotnet/standard/globalization-localization/best-practices-for-developing-world-ready-apps#localization-best-practices)。

- 简洁。 命令不应使用三个以上的单词。

- 使用词首字母大写：每个单词的首字母应大写。 有关 Visual Studio 中的文本格式设置的详细信息，请参阅[文本样式](../../extensibility/ux-guidelines/fonts-and-formatting-for-visual-studio.md#BKMK_TextStyle)。

- 请考虑命令的放置位置。 它是在顶级菜单还是浮出控件中？ 例如，在对浮出控件中的对齐方式进行分组时，顶级命令应为 "对齐"，而飞出的命令应为 "左"、"右"、"中心"、"对齐" 等。 将浮出性命令命名为 "左对齐" 或 "右对齐" 是冗余的。

     ![Visual Studio 格式菜单](../../extensibility/ux-guidelines/media/0502-a_formatmenu.png "0502-a_FormatMenu")

### <a name="using-icons-with-commands"></a>使用带有命令的图标
 在对命令使用图标配对时进行备用。 尽管将唯一的映像与命令相关联 hastens 用户识别该命令的能力，但图像过度使用会出现视觉干扰和效率低下。 以下规则可帮助确定是否创建命令图标。

#### <a name="use-an-icon-with-a-command-only-if"></a>仅在以下情况中使用带有命令的图标：

- 同一个命令在另一个突出的 Microsoft 产品（如 Microsoft Office 的应用程序之一）中有一个与之关联的图标。

- 命令将放置在默认工具栏中。

- 命令是一种专用命令，用户很可能会使用 **"自定义 ..."** 对话框将其添加到工具栏中。

## <a name="access-and-shortcut-keys"></a>访问和快捷键

### <a name="overview"></a>概述
 键盘键分配有两种类型：

- **访问键** (也称为加速器) 允许通过用于命令的菜单和对话框 UI 中的每个标签进行键盘访问。 访问键主要用于辅助功能，分配给所有菜单和大多数对话框控件，并不是缘故，只影响当前窗口并进行本地化。

- **快捷键** 大多使用 Control (Ctrl) 并 (Fn) 键顺序。 它们是为高级用户设计的，并有助于提高工作效率。 它们仅分配给最常使用的命令，并允许在不使用主菜单的情况下快速访问。 快捷键旨在缘故，因此，必须将其与配置文件方案一致。 快捷键方案可能因配置文件而异。 用户可以通过 " **工具" > 选项 > 键盘** 自定义快捷键。

### <a name="assigning-access-keys"></a>分配访问密钥
 访问键包含) 的 Alt 和字母数字键 (。 为每个菜单项分配一个访问键，而不发生异常。 遵循 Windows 和用于分配访问密钥的常见约定。 例如， **File > New** 的访问密钥应始终为 **Alt、F、N**。

 不要使用以大写或小写形式 (的 "i" 或小写的 "l") 或小写的 "l"，避免将字符与)  (下行字母一起使用，因为这种情况难以区分。

 如果可能，请避免使用重复键。 如果无法避免重复，菜单系统会通过循环遍历使用该键的所有命令来处理冲突。 例如，对于与 "N" 访问键重复的 "文件" 菜单下的假设 "Number" 命令， **alt、f、n** 会创建一个新文件，并且 **alt、f、n、n** 将执行 "Number" 命令。

### <a name="assigning-shortcut-keys"></a>分配快捷键
 避免分配新的快捷键，因为它们不是每个命令所必需的，并且对系统 (和用户内存) （如果过度滥用）都是必需的。 来自客户体验改善计划 (CEIP) 的数据指示 Visual Studio 用户仅使用集成快捷方式的一小部分。

 定义快捷方式时，请遵循以下规则：

- **使用 Control (Ctrl) 并 (Fn) 键顺序。**

- **保留常用的快捷方式。** 维护最常用的快捷方式。

- **使编辑器快捷方式易于键入。** 在编写代码时，将易于键入的快捷方式绑定到开发人员需要的命令。 例如， **InvokeSmartTag** 需要具有快捷键，如 Ctrl +/，而不是 Alt + Shift + F10。

- **努力实现一致的主题快捷方式。**

- **遵循 Windows 准则来确定要使用的修改键。** 对于具有大规模效果的命令（如应用于整个文档的命令），请使用 Ctrl 键组合。 对于扩展或补充标准快捷键操作的命令，请使用 Shift 键组合。 请勿使用 Ctrl + Alt 组合。

- **删除无关的快捷方式。** 如果有旧功能，请考虑删除用于极端 infrequency 的快捷方式， (从 CEIP 数据) 或适中的 infrequency 100 (低于 ceip 数据的10倍，) 如果访问密钥提供同一命令的快速访问权限。 例如： Alt、H、C 将打开 "帮助"/"内容"。

  没有一种简单的方法来检查快捷方式的可用性。 如果要添加快捷方式，请执行以下步骤：

1. 查看[Visual Studio 2013 快捷方式](http://visualstudioshortcuts.com/2013/)的列表，以确定是否有类似的命令用于对你的进行分组。

2. 请参阅 " **工具" > "选项" > 环境 > 键盘** 并测试快捷方式。 检查 "应用以下其他键盘映射方案" 下列出的每个键盘映射方案。 检查 "常规"、"c #"、"VB" 和 "c + +" 配置文件，因为这些配置文件 如果快捷方式未映射到任何位置，则可以使用快捷方式。
