---
title: Visual Studio 的菜单和命令 |Microsoft Docs
description: 了解在为 Visual Studio 创建新功能时，命令栏如何允许在用户界面中获得灵活性。
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: reference
ms.assetid: 0a1ed675-2bd1-4603-ba3a-f40dfb5cfb69
author: leslierichardson95
ms.author: lerich
manager: jmartens
ms.technology: vs-ide-sdk
ms.workload:
- vssdk
ms.openlocfilehash: e786e9557a0a2188d6a220e5aaccd943cad8cd5c
ms.sourcegitcommit: 68897da7d74c31ae1ebf5d47c7b5ddc9b108265b
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/13/2021
ms.locfileid: "122028470"
---
# <a name="menus-and-commands-for-visual-studio"></a>Visual Studio 的菜单和命令
## <a name="command-usage"></a>命令用法

### <a name="overview"></a>概述
 与 Microsoft Office （包含多个不同产品的套件）不同，Visual Studio 包含许多产品，每个产品都向全局 Visual Studio IDE 提供其命令集。 IDE 通过基于上下文筛选用户可用的功能，来管理上千个命令的复杂性。

 当用户的上下文更改时（如从设计窗口切换到代码编辑窗口），与新上下文无关的功能将消失。 同时，新功能与相关动态信息（如属性和工具箱选项）一起显示。 用户不应注意到可用命令集的交换。 如果用户被显示或消失，则需要调整 UI 设计。 用户的当前上下文始终以一种或多种方式表示，例如在 IDE 标题栏、属性窗口或 "属性页" 对话框中。

 命令栏允许用户在 UI 中提供灵活性。 Visual Studio 环境固有的唯一命令结构是主菜单和主命令栏，它们可以进行自定义，甚至隐藏。 其他命令栏会根据应用程序的状态出现和消失。 工具窗口和文档编辑器还可以包含其窗口边缘内的嵌入工具栏。

#### <a name="basic-guidelines"></a>基本指导原则

##### <a name="use-existing-shared-commands-command-groups-and-menus-whenever-possible"></a>尽可能使用现有的共享命令、命令组和菜单。
 由于命令通常基于上下文显示，因此使用现有共享菜单和命令组可确保命令结构在上下文中发生更改时保持相对稳定。 重复使用共享命令并将新命令放置到相关的共享命令中还可以降低 IDE 的复杂性，并创建更易于用户使用的体验。 如果需要定义新命令，请尝试将其放入现有的共享命令组。 如果需要定义新组，请在创建新的顶级菜单之前，将其放置在靠近相关命令组的现有共享菜单中。

##### <a name="do-not-create-icons-for-every-command"></a>不要为每个命令创建图标。
 在创建命令图标之前，请仔细考虑。 只应为以下命令创建图标：

- 显示在默认工具栏上。

- 用户可能会通过 " **自定义 ...** " 对话框向工具栏添加。

- 具有与其他 Microsoft 产品中的相同操作关联的图标。

##### <a name="limit-the-addition-of-keyboard-shortcuts"></a>限制键盘快捷方式的增加
 大多数用户都使用了一小部分可用的快捷方式。 如果有疑问，请勿将功能绑定到键盘快捷键。 在添加新的快捷方式之前，请与用户体验团队合作。

##### <a name="give-commands-a-default-menu-placement"></a>为命令指定默认菜单位置。
 请注意，你的命令将由其他人自定义并进行相应的设计。 隐藏命令没有这样的内容。 所有 Visual Studio 命令都显示在 "**工具" > 自定义**"对话框、" 命令 "窗口、" 自动完成 "、"**工具 > 选项 > 键盘**"对话框和" 开发工具 "环境 (DTE) 中。 请确保在 .ctc 文件中为命令提供名称和工具提示，以便用户可以轻松找到它们。

##### <a name="do-not-duplicate-shared-commands-on-an-embedded-toolbar"></a>不要复制嵌入工具栏上的共享命令。
 将命令放在靠近用户焦点区域的位置很有用。 实现此目的的一种方法是在工具窗口或文档编辑器的顶部创建一个嵌入工具栏。 放置在工具栏上的命令应特定于窗口内的内容区域。 请勿在这些工具栏上复制共享命令。 例如，不要在嵌入的工具栏中放置一个 "保存" 图标。

### <a name="content-and-command-visibility"></a>内容和命令可见性
 以下作用域中存在命令： **环境**、 **层次结构** 和 **文档**。 请了解每个作用域，以便信任命令位置。

 **环境** 范围中的命令建立主上下文并在多个上下文之间共享。 它们改变文档和工具窗口的可见性或排列方式。 环境范围中的命令包括新的 **Project**，**连接服务器**，**附加进程**、**剪切**、**复制**、**粘贴**、**查找**、**选项**、**自定义**、**新窗口** 和 **查看帮助**。

 **层次结构** 范围内的命令管理 Visual Studio 中的层次结构，包括 **Project**、**团队** 和 **数据**。 它们与项目的子上下文有关，例如 " **调试**"、" **生成**"、" **测试**"、" **体系结构**" 或 " **分析**"。 在层次结构范围内的命令中，**添加新项**、**新查询**、 **Project 设置**、**添加新数据源**、**启动性能向导** 和 **新关系图**。

 **文档** 范围中的命令作用于文档的内容，如代码、设计或 (.wiq) 的工作项查询。 它们还作用于工具窗口的视图，或特定于该工具窗口。 文档作用域命令还作用于自身层次结构特定的文件对象，例如 **从 Project 中删除**。 文档范围中的命令包括 **重构 > 重命名**、 **创建工作项的副本**、 **全部展开**、全部 **折叠** 和 **创建用户任务**。

### <a name="command-placement-decisions"></a>命令放置决策
 确定创建命令后，需要确定其适当的位置以及是否要创建键盘快捷方式。 按照此决策路径建立命令的放置位置：

 ![命令放置决策图表](../../extensibility/ux-guidelines/media/0501-a_commandplacement.png "0501-a_CommandPlacement")

 **命令放置在 Visual Studio 中的决策路径**

### <a name="command-placement-in-menus"></a>菜单中的命令放置

#### <a name="main-menu-bar"></a>主菜单栏
 主菜单栏应为适用于 UI 的任何上下文特定菜单包的命令的标准位置。 主菜单栏与其他命令结构的不同之处在于，环境使用它控制哪些命令可见。 所有其他命令栏只是禁用上下文外的命令，无论它们是放置在菜单上，还是位于工具栏上。

 环境定义一组内置于主菜单栏的命令，这些命令在整个 IDE 和多个任务域中都是通用的。 无论哪些 Vspackage 加载到环境中，这些命令始终可见。 尽管 Vspackage 可以扩展此命令集，但是每个产品的命令集和命令的位置都是每个团队的责任。

 Visual Studio 主菜单的结构可以细分为以下菜单类别：

##### <a name="core-menus"></a>核心菜单

- 文件

- 编辑

- 查看

- 工具

- 窗口

- 帮助

##### <a name="project-specific-menus"></a>Project 特定的菜单

- Project

- 构建

- 调试

##### <a name="context-specific-menus"></a>上下文特定菜单

- 组

- 数据

- 测试

- 体系结构

- 分析

##### <a name="document-specific-menus"></a>文档特定的菜单

- 格式

- 表

##### <a name="when-designing-main-menus-adhere-to-these-rules"></a>设计主菜单时，遵循以下规则：

- 给定的上下文中不能超过25个顶级项

- 菜单的高度不应超过600像素。

- 评估多个上下文中的主菜单，如最终 SKU 和常规配置文件中的。

- 可接受飞出菜单。

- 飞出菜单应该包含至少三个项目，不能超过7个。

- 飞出菜单应该只会有一个级别的深度，某些 Visual Studio 菜单项具有级联子菜单，但是不建议使用此模式。

- 使用不超过六个分隔符。 分组应遵循下图：

     ![主菜单分组指南](../../extensibility/ux-guidelines/media/0501-b_mainmenus.png "0501-b_MainMenus")

- 虽然图中不需要每个分组，但添加其他分组却受到限制。

- 每个分组应有两到七个菜单项。

#### <a name="main-menu-ordering"></a>主菜单排序
 在添加新的顶级项之前，请考虑将命令置于现有的顶级菜单中。 添加新的顶级菜单时，请确保将其放在正确的位置。 决定菜单是特定于项目、上下文还是文档。 使顶级菜单的名称简洁明了，只使用一个词。

 核心菜单应 bookend 命令的其余部分。 "文件"、"编辑" 和 "视图" 应始终在左侧，而 "工具"、"窗口" 和 "帮助" 应始终位于右侧。

#### <a name="context-menus"></a>上下文菜单
 在上下文菜单中放置过多功能会导致难以理解的界面。 所有主要功能都应该通过主菜单栏提供。 应将命令的位置与现有命令协调在一起，以避免重复的命令。 对于上下文菜单，shell 定义应该包含的标准菜单组，具体取决于上下文菜单是用于解决方案、项目节点还是项目项。

 设计上下文菜单时，遵循与主菜单相同的规则，此外还包括：

- 不能超过25个顶级菜单项。

- 飞出菜单是可接受的，但不得超出一级-从不使用级联浮出控件。

- 使用不超过六个分隔符。

### <a name="command-placement-in-toolbars"></a>工具栏中的命令放置

#### <a name="general-toolbars"></a>常规工具栏
 设计和排列工具栏时，请遵循以下标准：

- 不要对每个按钮使用多个谓词。 一个按钮 = 一个操作。

- 仅当需要使用标签来加强时，将文本与图标一起使用。

- 仅将组合框用于在一个会话中多次切换的属性。 否则，在其他位置公开此属性。

- 组合框的宽度应该等于框中最大项的宽度 + 30%。 例如，如果最长的项为200像素，则组合框的宽度应为260像素。

- 限制使用分隔符。 在下拉列表旁边使用分隔符是一种反模式，因为下拉列表本身的形状用作视觉分隔符。

- 图标组应包含三到六个图标。

- 如果限定符产生多个有用的命令，请使用存储最后一个设置的拆分按钮：

     ![Visual Studio 中的“拆分”按钮](../../extensibility/ux-guidelines/media/0501-c_splitbuttons.png "0501-c_SplitButtons")

     **拆分按钮的示例。左侧的六个命令可以转到单个按钮。**

#### <a name="product-specific-toolbars"></a>特定于产品的工具栏
 每个产品都可以提供一个默认的工具栏，其中包含经常使用的和重要的命令，每个产品的默认工具栏应在产品安装后第一次启动 Visual Studio 时显示。

 产品还应利用 IDE 提供的共享命令组和菜单。 每个共享命令组放置在一个共享菜单中，旨在以一种有意义的方式为用户组织相关命令。 务必要利用此共享的命令结构，以降低复杂性。

#### <a name="global-toolbars"></a>全局工具栏
 需要全局工具栏，才能在右侧容纳一行。 创建新的全局工具栏时，请遵循该工具栏类型的指导原则。

 **常规工具栏指南：**

- 每个工具栏在公共控件中有24个像素 (手柄，溢出) 。

- 每个工具栏按钮都是22像素宽，包括填充。 将图标设为拆分按钮将增加11个宽度的宽度。

- 允许跨工具栏复制命令。

  特定文件类型处于活动状态时，将显示 **特定于文档的工具栏**，在不同的文件类型变为活动状态时消失。

- 特定于文档的工具栏不能有12个以上的按钮。

- 工具栏的总宽度不得超过300像素。

- 每个文件类型可以有一个嵌入工具栏或一个特定于文档的全局工具栏，但不能同时包含两者。

  设置特定上下文时，将显示 **特定于上下文的工具栏**，并使长时间保持活动状态。

- 所有特定于上下文的工具栏的按钮限制为18。

- 如果大多数用户在上下文处于活动状态时不会一直使用此工具栏的命令，则不要将此工具栏与上下文相关联。

- 确保在退出上下文时工具栏消失。 在启动时，这些工具栏都不应出现。

  不会自动显示 **没有上下文的工具栏**。 仅当用户激活这些文件时，才会显示这些。 将最大宽度保持为200像素以下。

### <a name="general-organization-and-shell-defined-groups"></a>一般组织和 shell 定义的组
 使用现有的共享命令、命令组和菜单。 如果需要定义新命令，请尝试将其放入现有的共享命令组。 如果需要定义新组，请在创建新的顶级菜单之前，尝试将其放在靠近相关命令组的现有共享菜单中。 这会降低命令的复杂性，同时确保 IDE 中的命令位置一致。

 下图演示了 "共享 **格式** " 菜单，通常显示在设计器样式的文档窗口的上下文中：

 ![具有标注的 Visual Studio 格式菜单](../../extensibility/ux-guidelines/media/0501-d_formatmenu.png "0501-d_FormatMenu")

 **Visual Studio 中的菜单组**

### <a name="reducing-and-reusing-commands"></a>减少和重复使用命令
 命令通常基于上下文显示，以减少用户在任意给定时间看到的命令数。 但是，还应重复使用现有的共享菜单和命令组，以确保在上下文中发生更改时，命令结构保持相对稳定。

 重复使用共享命令并将新的命令放在相关的共享命令上可降低 IDE 复杂性，并创建更易于用户使用的体验。

## <a name="naming-commands"></a>命名命令

### <a name="naming-conventions"></a>命名约定
 一致的命令命名非常重要，因此用户可以通过使用命令行或绑定到键盘快捷键来查找和执行命令。 命令名称还有助于用户了解命令在工具栏上或级联或上下文菜单中显示时的作用。

#### <a name="when-naming-commands"></a>命名命令时：

- 构建文本，使其易于本地化。 有关本地化文本的详细信息，请参阅 [本地化最佳实践](/dotnet/standard/globalization-localization/best-practices-for-developing-world-ready-apps#localization-best-practices)。

- 简洁。 命令不应使用三个以上的单词。

- 使用词首字母大写：每个单词的首字母应大写。 有关 Visual Studio 中的文本格式设置的详细信息，请参阅[文本样式](../../extensibility/ux-guidelines/fonts-and-formatting-for-visual-studio.md#BKMK_TextStyle)。

- 请考虑命令的放置位置。 它是在顶级菜单还是浮出控件中？ 例如，在对浮出控件中的对齐方式进行分组时，顶级命令应为 "对齐"，而飞出的命令应为 "左"、"右"、"中心"、"对齐" 等。 将浮出性命令命名为 "左对齐" 或 "右对齐" 是冗余的。

     ![Visual Studio 格式菜单](../../extensibility/ux-guidelines/media/0502-a_formatmenu.png "0502-a_FormatMenu")

### <a name="using-icons-with-commands"></a>使用带有命令的图标
 在对命令使用图标配对时进行备用。 尽管将唯一的映像与命令相关联 hastens 用户识别该命令的能力，但图像过度使用会出现视觉干扰和效率低下。 以下规则可帮助确定是否创建命令图标。

#### <a name="use-an-icon-with-a-command-only-if"></a>仅在以下情况中使用带有命令的图标：

- 同一个命令在另一个突出的 Microsoft 产品（如 Microsoft Office 的应用程序之一）中有一个与之关联的图标。

- 命令将放置在默认工具栏中。

- 命令是一种专用命令，用户很可能会使用 **"自定义 ..."** 对话框将其添加到工具栏中。

## <a name="access-and-shortcut-keys"></a>访问和快捷键

### <a name="overview"></a>概述
 键盘键分配有两种类型：

- **访问键** (也称为加速器) 允许通过用于命令的菜单和对话框 UI 中的每个标签进行键盘访问。 访问键主要用于辅助功能，分配给所有菜单和大多数对话框控件，并不是缘故，只影响当前窗口并进行本地化。

- **快捷键主要** 使用 Ctrl (控件) Fn (函数) 键序列。 它们专为高级用户设计，有助于提高工作效率。 它们仅分配给最常用的命令，并允许在绕过主菜单时快速访问。 快捷键旨在记住，因此必须分配与配置文件方案一致的快捷键。 快捷键方案可能因配置文件而异。 用户可以通过"工具"和"选项> **键盘 >快捷键**。

### <a name="assigning-access-keys"></a>分配访问密钥
 访问密钥由 Alt 和字母数字 (组成) 。 向每个菜单项分配访问密钥，无异常。 遵循Windows访问密钥的常见约定。 例如，"新建> **的访问** 密钥应始终 **为 Alt、F、N**。

 请勿使用单像素宽度字母（如大写或小写字母) 或小写 "l"中的"i" (）并避免将字符与降序字母 (g、j、p、q 和 y) 一起使用，因为二者难以区分。

 尽可能避免使用重复键。 如果重复无法避免，菜单系统会通过循环访问使用该键的所有命令来处理冲突。 例如，对于复制"N"访问密钥的"文件"菜单下的假设"Number"命令 **，Alt、F、N** 将创建一个新文件 **，Alt、F、N、N** 将执行"Number"命令。

### <a name="assigning-shortcut-keys"></a>分配快捷键
 避免分配新的快捷键，因为它们并非每个命令都是必需的，并且对系统内存和用户 (产生) 使用。 来自 客户体验改善计划 (CEIP) 指示Visual Studio用户仅使用集成快捷方式的一小部分。

 定义快捷方式时，请遵循以下规则：

- **使用 Ctrl (Ctrl) 和 Function (Fn) 键序列。**

- **保留常用的快捷方式。** 保留最常用的快捷方式。

- **使编辑器快捷方式易于键入。** 将易于键入的快捷方式绑定到开发人员在编写代码时最常用的命令。 例如 **，Edit.InvokeSmartTag** 需要具有快速快捷键（如 Ctrl+/ ），而不是 Alt+Shift+F10。

- **尽量使用一致的带提示的快捷方式。**

- **按照Windows指南来确定要采用哪个修饰符键。** 对具有大规模效果的命令（例如应用于整个文档的命令）使用 Ctrl 组合键。 对扩展或补充标准快捷键操作的命令使用 Shift 组合键。 请勿使用 Ctrl+Alt 组合。

- **删除多余的快捷方式。** 如果具有旧版功能，请考虑从 CEIP 数据) 中删除使用非常不频繁 (次以下的快捷方式 (或者，如果访问密钥提供对同一命令的快速访问) 则从 CEIP 数据中删除不经常使用 (次以下的快捷方式。 例如：Alt、H、C 将打开"帮助/内容"。

  没有一种简单的方式来检查快捷方式可用性。 如果要添加快捷方式，请执行以下步骤：

1. 检查这些Visual Studio 2013[列表](http://visualstudioshortcuts.com/2013/)，以确定是否有类似的命令用于对命令进行分组。

2. 转到" **工具>选项>">键盘"** 并测试快捷方式。 检查"应用以下附加键盘映射方案"下列出的每个键盘映射方案。 检查常规、C#、VB和 C++ 配置文件，因为这些配置文件共享唯一的快捷方式。 如果快捷方式未映射到其中任何位置，则快捷方式可用。
