---
title: VSIX 颜色编辑器 |Microsoft Docs
description: 了解 Visual Studio 扩展颜色编辑器工具，该工具可为 Visual Studio 创建和编辑自定义颜色并生成主题资源键。
ms.custom: SEO-VS-2020
ms.date: 11/04/2016
ms.topic: reference
ms.assetid: 70879c5d-e0f0-4845-993c-2f4229869706
author: leslierichardson95
ms.author: lerich
manager: jmartens
ms.technology: vs-ide-sdk
ms.workload:
- vssdk
ms.openlocfilehash: e19105a9b769810011b5ae3871a3cae03e2bd48611087244fecf5ed40734067a
ms.sourcegitcommit: c72b2f603e1eb3a4157f00926df2e263831ea472
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/12/2021
ms.locfileid: "121275094"
---
# <a name="vsix-color-editor"></a>VSIX 颜色编辑器
Visual Studio 扩展颜色编辑器工具可为 Visual Studio 创建和编辑自定义颜色。 该工具还可以生成主题资源键，以便可以在代码中使用这些颜色。 此工具适用于为支持主题的 Visual Studio 扩展创建颜色。 此工具可以打开 .pkgdef 和 .xml 文件。 可以通过将文件扩展名更改为 .xml，将 Visual Studio 主题 ( 的 vstheme 文件) 与 Visual Studio 扩展颜色编辑器一起使用。 此外，vstheme 文件可以导入到当前 .xml 文件中。

 ![VSIX 颜色编辑器 Hero](../../extensibility/internals/media/vsix-color-editor-hero.png "VSIX 颜色编辑器 Hero")

 **包定义文件**

 包定义 (. .pkgdef) 文件是定义主题的文件。 颜色本身存储在 .pkgdef 文件中的主题颜色 .xml 文件中。 .pkgdef 文件部署到 Visual Studio 可搜索位置、在运行时处理，并合并在一起以定义主题。

 **颜色标记**

 颜色标记由四个元素组成：

- **类别名称：** 一组颜色的逻辑分组。 如果已有特定于所需 UI 元素或 UI 元素组的颜色，请使用现有类别名称。

- **令牌名称：** 颜色标记和标记集的描述性名称。 设置包括背景和前景 (文本) 标记名称及其所有状态，并且这些内容应命名为，以便能够轻松地识别对它们所应用的对。

- **颜色值 (或色相) ：** 每个彩色主题都需要。 始终成对创建背景和文本颜色值。 颜色与背景/前景配对，使文本 (前景) 颜色始终可根据绘制它的背景色进行读取。 这些颜色已链接，并将在 UI 中一起使用。 如果背景不适合用于文本，请不要定义前景色。

- **系统颜色名称：** 用于高对比度显示。

## <a name="how-to-use-the-tool"></a>如何使用该工具
 尽可能多地使用现有 Visual Studio 颜色，而不是生成新颜色。 但是，对于未定义适当颜色的情况，应创建自定义颜色以使扩展主题兼容。

 **创建新的颜色标记**

 若要使用 Visual Studio 扩展颜色编辑器创建自定义颜色，请执行以下步骤：

1. 确定新颜色标记的类别名称和标记名称。

2. 选择 UI 元素将用于每个主题的色相和高对比度的系统颜色。

3. 使用颜色编辑器创建新的颜色标记。

4. 使用 Visual Studio 扩展中的颜色。

5. 测试 Visual Studio 中的更改。

   **步骤1：确定新颜色标记的类别名称和标记名称。**

   VSColor 的首选命名方案为 **[类别] [UI 类型] [状态]**。 请勿在 VSColor 名称中使用 "color" 一词，因为它是多余的。

   类别名称提供逻辑分组，并且应尽可能将其定义为最窄。 例如，单个工具窗口的名称可以是类别名称，而是整个业务单元或项目团队的名称。 将条目分组到类别中有助于避免在具有相同名称的颜色之间发生混淆。

   标记名称必须清楚地指示将应用颜色的元素类型和条件，或 "状态"。 例如，活动数据提示的 **[UI 类型]** 可以命名为 "**数据提示**"，而将 **[State]** 命名为 "**active**"，导致颜色名称为 "**DataTipActive**"。 由于数据提示包含文本，因此需要定义前台和背景色。 使用背景/前景配对，颜色编辑器将自动为背景创建颜色 "**DataTipActive**"，为前景自动创建 "**DataTipActiveText**"。

   如果 UI 部分只有一个状态，则可以省略名称的 **[state]** 部分。 例如，如果搜索框有边框，并且没有影响边框颜色的状态更改，则可以简单地将边框的颜色标记名称称为 "**SearchBoxBorder**"。

   一些常见的状态名称包括：

- 可用

- 非活动

- MouseOver

- MouseDown

- 选定

- 已设定焦点

  部分列表项控件的标记名称示例：

- ListItem

- ListItemBorder

- ListItemMouseOver

- ListItemMouseOverBorder

- ListItemSelected

- ListItemSelectedBorder

- ListItemDisabled

- ListItemDisabledBorder

  **步骤2：选择 UI 元素将用于每个主题的色相和高对比度的系统颜色。**

  为 UI 选择自定义颜色时，选择类似的现有 UI 元素，并使用其颜色作为基准。 内置 UI 元素的颜色已经历了评审和测试，因此它们将在所有主题中正确地显示和运行。

  **步骤3：使用颜色编辑器创建新的颜色标记。**

  启动颜色编辑器，并 .xml 文件中打开或创建一个新的自定义主题颜色。 从菜单中选择 " **编辑 > 新颜色** "。 这将打开一个对话框，用于为该类别中的颜色条目指定类别和一个或多个名称：

  ![VSIX 颜色编辑器 新颜色](../../extensibility/internals/media/vsix-color-editor-new-color.png "VSIX 颜色编辑器 新颜色")

  选择现有类别，或选择 " **新建类别** " 以创建一个新类别。 将打开另一个对话框，并创建新的类别名称：

  ![VSIX 颜色编辑器 新类别](../../extensibility/internals/media/vsix-color-editor-new-category.png "VSIX 颜色编辑器 新类别")

  新类别随后将在 " **新建颜色** 类别" 下拉菜单中变为可用。 选择类别后，为每个新颜色标记输入每行名称，完成后，请选择 "创建"：

  ![VSIX 颜色编辑器 填充新颜色](../../extensibility/internals/media/vsix-color-editor-new-color-filled.png "VSIX 颜色编辑器 填充新颜色")

  颜色值以背景/前景对显示，其中 "无" 表示尚未定义颜色。 注意：如果颜色没有文本颜色/背景色对，则只需定义背景。

  ![VSIX 颜色编辑器 颜色值](../../extensibility/internals/media/vsix-color-editor-color-values.png "VSIX 颜色编辑器 颜色值")

  若要编辑颜色标记，请为该标记的主题 (列) 选择颜色条目。 添加颜色值的方法是：以8位 ARGB 格式键入十六进制颜色值，在单元格中输入系统颜色名称，或使用下拉菜单通过一组颜色滑块或系统颜色列表选择所需的颜色。

  ![VSIX 颜色编辑器 编辑颜色](../../extensibility/internals/media/vsix-color-editor-edit-color.png "VSIX 颜色编辑器 编辑颜色")

  ![VSIX 颜色编辑器 背景](../../extensibility/internals/media/vsix-color-editor-background.png "VSIX 颜色编辑器 背景")

  对于不需要显示文本的组件，只需输入一个颜色值：背景色。 否则，请输入背景和文本颜色的值，用正斜杠分隔。

  输入高对比度的值时，请输入有效的 Windows 系统颜色名称。 请勿输入硬编码 ARGB 值。 您可以通过从 "颜色值" 下拉菜单中选择 "背景：系统" 或 "前景：系统"，查看有效系统颜色名称的列表。 创建具有文本组件的元素时，请使用正确的背景/文本系统颜色对，否则文本可能不可读。

  完成创建、设置和编辑颜色标记后，将其保存到所需的 .xml 或 .pkgdef 格式。 既没有背景也没有前景集的颜色标记将以 .xml 格式保存为空白颜色，但会以 .pkgdef 格式丢弃。 如果尝试将空白颜色保存到 .pkgdef 文件，则对话框将警告您可能会出现颜色损失。

  **步骤4：使用 Visual Studio 扩展中的颜色。**

  定义新的颜色标记后，将 "生成操作" 设置为 "内容"，并将 "Include in VSIX" 设置为 "True"，将项目文件中的 .pkgdef 包括在内。

  ![VSIX 颜色编辑器 pkgdef](../../extensibility/internals/media/vsix-color-editor-pkgdef.png "VSIX 颜色编辑器 pkgdef")

  在 Visual Studio 扩展颜色编辑器中，选择 "文件" > "查看资源代码"，查看用于在基于 WPF 的 UI 中访问自定义颜色的代码。

  ![VSIX 颜色编辑器 资源代码查看器](../../extensibility/internals/media/vsix-color-editor-resource-code-viewer.png "VSIX 颜色编辑器 资源代码查看器")

  将此代码包含在项目中的静态类上。 需要将对 **\<VSVersion>.0.dllVisualStudio** 的引用添加到项目中，才能使用 **ThemeResourceKey** 类型。

```csharp
namespace MyCustomColors
{
    public static class MyCategory
    {
        #region Autogenerated resource keys
        // These resource keys are generated by Visual Studio Extension Color Editor, and should be replaced when new colors are added to this category.
        public static readonly Guid Category = new Guid("faf7f3f9-9fe5-4dd3-9350-59679617dfbe");

        private static ThemeResourceKey _MyColor1ColorKey;
        private static ThemeResourceKey _MyColor1BrushKey;
        private static ThemeResourceKey _MyColor1TextColorKey;
        private static ThemeResourceKey _MyColor1TextBrushKey;
        public static ThemeResourceKey MyColor1ColorKey { get { return _MyColor1ColorKey ?? (_MyColor1ColorKey = new ThemeResourceKey(Category, "MyColor1", ThemeResourceKeyType.BackgroundColor)); } }
        public static ThemeResourceKey MyColor1BrushKey { get { return _MyColor1BrushKey ?? (_MyColor1BrushKey = new ThemeResourceKey(Category, "MyColor1", ThemeResourceKeyType.BackgroundBrush)); } }
        public static ThemeResourceKey MyColor1TextColorKey { get { return _MyColor1TextColorKey ?? (_MyColor1TextColorKey = new ThemeResourceKey(Category, "MyColor1", ThemeResourceKeyType.ForegroundColor)); } }
        public static ThemeResourceKey MyColor1TextBrushKey { get { return _MyColor1TextBrushKey ?? (_MyColor1TextBrushKey = new ThemeResourceKey(Category, "MyColor1", ThemeResourceKeyType.ForegroundBrush)); } }
        #endregion
    }
}
```

 这样就可以访问 XAML 代码中的颜色，并允许 UI 响应主题更改。

```xaml
<UserControl x:Class="NewTestProject.TestPackageControl" Name="MyToolWindow"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:ns="clr-namespace:MyCustomColors">
  <Grid>
    <TextBlock Background="{DynamicResource {x:Static ns:MyCategory.MyColor1BrushKey}}"
               Foreground="{DynamicResource {x:Static ns:MyCategory.MyColor1TextBrushKey}}"
      >Sample Text</TextBlock>

  </Grid>
</UserControl>
```

 **步骤5：测试 Visual Studio 中的更改。**

 颜色编辑器可以暂时将颜色标记应用到 Visual Studio 的正在运行的实例，以查看对颜色的实时更改而无需重新生成扩展包。 为此，请单击位于每个主题列标题上的 "应用此主题以运行 Visual Studio windows" 按钮。 当 VSIX 颜色编辑器关闭时，此临时主题将消失。

 ![VSIX 颜色编辑器 应用](../../extensibility/internals/media/vsix-color-editor-apply.png "VSIX 颜色编辑器 应用")

 若要使更改永久生效，请在将新颜色添加到 .pkgdef 文件并编写将使用这些颜色的代码后，重新生成并重新部署 Visual Studio 扩展。 重新生成 Visual Studio 扩展会将新颜色的注册表值合并到主题的其余部分。 然后重新启动 Visual Studio，查看 UI，并验证新颜色是否按预期方式显示。

## <a name="notes"></a>说明
 此工具旨在用于为预先存在的 Visual Studio 主题创建自定义颜色，或用于编辑自定义 Visual Studio 主题的颜色。 若要创建完整的自定义 Visual Studio 主题，请从 Visual Studio 扩展库下载[Visual Studio 颜色主题编辑器扩展](https://marketplace.visualstudio.com/items?itemName=VisualStudioProductTeam.VisualStudio2015ColorThemeEditor)。

## <a name="sample-output"></a>示例输出
 **XML 颜色输出**

 该工具生成的 .xml 文件如下所示：

```xml
<Themes>
  <Theme Name="Light" GUID="{de3dbbcd-f642-433c-8353-8f1df4370aba}">
    <Category Name="CategoryName" GUID="{eee9d521-dac2-48d9-9a5e-5c625ba2040c}">
      <Color Name="ColorName1">
        <Background Type="CT_RAW" Source="FFFFFFFF" />
      </Color>
      <Color Name="ColorName2">
        <Background Type="CT_RAW" Source="FFFFFFFF" />
        <Foreground Type="CT_RAW" Source="FF000000" />
      </Color>
      <Color Name="ColorName3">
        <Background Type="CT_RAW" Source="FFFF0000" />
      </Color>
      <Color Name="ColorName4">
        <Background Type="CT_RAW" Source="FF000088" />
        <Foreground Type="CT_RAW" Source="FFFFFFFF" />
      </Color>
    </Category>
  </Theme>
  <Theme Name="Dark" GUID="{1ded0138-47ce-435e-84ef-9ec1f439b749}">...</Theme>
  <Theme Name="Blue" GUID="{a4d6a176-b948-4b29-8c66-53c97a1ed7d0}">...</Theme>
  <Theme Name="HighContrast" GUID="{a5c004b4-2d4b-494e-bf01-45fc492522c7}">...</Theme>
</Themes>

```

 **.PKGDEF 彩色输出**

 该工具生成的 .pkgdef 文件如下所示：

```
[$RootKey$\Themes\{de3dbbcd-f642-433c-8353-8f1df4370aba}\CategoryName]
"Data"=hex:78,00,00,00,0b,00,00,00,01,00,00,00,21,d5,e9,ee,c2,da,d9,48,9a,5e,5c,62,5b,a2,04,0c,04,00,00,00,0a,00,00,00,43,6f,6c,6f,72,4e,61,6d,65,31,01,ff,ff,ff,ff,00,0a,00,00,00,43,6f,6c,6f,72,4e,61,6d,65,32,01,ff,ff,ff,ff,01,00,00,00,ff,0a,00,00,00,43,6f,6c,6f,72,4e,61,6d,65,33,01,ff,00,00,ff,00,0a,00,00,00,43,6f,6c,6f,72,4e,61,6d,65,34,01,00,00,88,ff,01,ff,ff,ff,ff
[$RootKey$\Themes\{1ded0138-47ce-435e-84ef-9ec1f439b749}\CategoryName]
"Data"=hex:...
[$RootKey$\Themes\{a4d6a176-b948-4b29-8c66-53c97a1ed7d0}\CategoryName]
"Data"=hex:...
[$RootKey$\Themes\{a5c004b4-2d4b-494e-bf01-45fc492522c7}\CategoryName]
"Data"=hex:...

```

 **C # 资源键包装器**

 该工具生成的颜色资源键将类似于以下内容：

```csharp
namespace MyNamespace
{
    public static class MyColors
    {
        #region Autogenerated resource keys
        // These resource keys are generated by Visual Studio Extension Color Editor, and should be replaced when new colors are added to this category.

        public static string ColorName1ColorKey { get { return "ColorName1ColorKey"; } }
        public static string ColorName1BrushKey { get { return "ColorName1BrushKey"; } }

        public static string ColorName2ColorKey { get { return "ColorName2ColorKey"; } }
        public static string ColorName2BrushKey { get { return "ColorName2BrushKey"; } }
        public static string ColorName2TextColorKey { get { return "ColorName2TextColorKey"; } }
        public static string ColorName2TextBrushKey { get { return "ColorName2TextBrushKey"; } }

        public static string ColorName3ColorKey { get { return "ColorName4ColorKey"; } }
        public static string ColorName3BrushKey { get { return "ColorName4BrushKey"; } }
        public static string ColorName3TextColorKey { get { return "ColorName4TextColorKey"; } }
        public static string ColorName3TextBrushKey { get { return "ColorName4TextBrushKey"; } }
        #endregion
    }
}
```

 **WPF 资源字典包装器**

 该工具生成的 " **ResourceDictionary** 密钥" 类似于以下内容：

```xaml
<ResourceDictionary xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:colors="clr-namespace:MyNamespace">

  <SolidColorBrush x:Key="{x:Static colors:MyColors.ColorName1BrushKey}" Color="#FFFFFFFF" />
  <Color x:Key="{x:Static colors:MyColors.ColorName1ColorKey}" A="255" R="255" G="255" B="255" />

  <SolidColorBrush x:Key="{x:Static colors:MyColors.ColorName2BrushKey}" Color="#FFFFFFFF" />
  <Color x:Key="{x:Static colors:MyColors.ColorName2ColorKey}" A="255" R="255" G="255" B="255" />
  <SolidColorBrush x:Key="{x:Static colors:MyColors.ColorName2TextBrushKey}" Color="#FF000000" />
  <Color x:Key="{x:Static colors:MyColors.ColorName2TextColorKey}" A="255" R="0" G="0" B="0" />

  <SolidColorBrush x:Key="{x:Static colors:MyColors.ColorName3BrushKey}" Color="#FFFF0000" />
  <Color x:Key="{x:Static colors:MyColors.ColorName3ColorKey}" A="255" R="255" G="0" B="0" />

  <SolidColorBrush x:Key="{x:Static colors:MyColors.ColorName4BrushKey}" Color="#FF000088" />
  <Color x:Key="{x:Static colors:MyColors.ColorName4ColorKey}" A="255" R="0" G="0" B="136" />
  <SolidColorBrush x:Key="{x:Static colors:MyColors.ColorName4TextBrushKey}" Color="#FFFFFFFF" />
  <Color x:Key="{x:Static colors:MyColors.ColorName4TextColorKey}" A="255" R="255" G="255" B="255" />
</ResourceDictionary>
```
